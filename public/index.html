<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Международные Олимпиады</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{--primary:#1b365d;--accent:#2ecc71;--bg:#f5f7fb;--text:#2b2b2b}
    *{box-sizing:border-box;margin:0;padding:0}body{font-family:Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{background:var(--primary);color:#fff;padding:20px;text-align:center}
    .container{max-width:800px;margin:20px auto;padding:0 16px}
    .btn{padding:10px 16px;background:var(--primary);color:#fff;border:none;border-radius:6px;cursor:pointer;margin:4px}
    .panel{background:#fff;padding:20px;margin:20px 0;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}
    input{width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:4px}
    footer{background:var(--primary);color:#fff;padding:16px;text-align:center;font-size:14px;margin-top:40px}
    footer a{color:#fff;text-decoration:underline}
    pre{white-space:pre-wrap;background:#f9fafb;padding:12px;border-radius:8px;margin:10px 0}
  </style>
</head>
<body>
<header><h1>Международные Олимпиады</h1></header>
<div class="container">
  <div class="panel">
    <h3>Международная Олимпиада по статистике и прикладной математике</h3>
    <pre>Полный текст олимпиады...</pre>
    <button class="btn" onclick="openReg('stat')">Регистрация</button>
  </div>
  <div class="panel">
    <h3>Международная Олимпиада по финансовым вычислениям</h3>
    <pre>Полный текст олимпиады...</pre>
    <button class="btn" onclick="openReg('fin')">Регистрация</button>
  </div>
  <div class="panel">
    <h3>Международная Олимпиада «Теория вероятностей в экономике»</h3>
    <pre>Полный текст олимпиады...</pre>
    <button class="btn" onclick="openReg('prob')">Регистрация</button>
  </div>

  <div id="regPanel" class="panel" style="display:none;">
    <h3 id="regTitle">Регистрация</h3>
    <input id="fio" placeholder="ФИО" value="Иванов Иван Иванович">
    <input id="school" placeholder="Учебное заведение" value="ФГБОУ ВО Кубанский государственный аграрный университет имени И.Т. Трубилина">
    <input id="region" placeholder="Регион" value="Краснодарский край">
    <input id="city" placeholder="Город" value="Краснодар">
    <button class="btn" onclick="generateAll()">Сформировать документы</button>
  </div>
</div>
<footer>
  Почта для связи: <a href="mailto:naych_kooper@mail.ru">naych_kooper@mail.ru</a><br>
  © 2025 Все права защищены. Копирование контента без разрешения автора строго ЗАПРЕЩЕНО!
</footer>

<script>
let currentEvent = null;

function openReg(key) {
  const titles = {
    'stat': 'Международная Олимпиада по статистике и прикладной математике',
    'fin': 'Международная Олимпиада по финансовым вычислениям в банковском секторе',
    'prob': 'Международная Олимпиада «Применение Теории вероятностей в экономике»'
  };
  currentEvent = titles[key];
  document.getElementById('regTitle').textContent = 'Регистрация: ' + currentEvent;
  document.getElementById('regPanel').style.display = 'block';
}

async function generatePDF(type) {
  const data = {
    title: currentEvent,
    fio: document.getElementById('fio').value,
    school: document.getElementById('school').value,
    region: document.getElementById('region').value,
    city: document.getElementById('city').value,
    supervisor: 'Лоскутов Лоскут Лоскутович'
  };
  const res = await fetch('/api/generate-pdf', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({template: type, data})
  });
  if (res.ok) {
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${type}.pdf`;
    a.click();
    URL.revokeObjectURL(url);
  }
}

function generateAll() {
  generatePDF('certificate');
  generatePDF('diploma');
  generatePDF('thanks');
}
</script>
</body>
</html>
