<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Документы и оплата</title>
  <style>
    :root{--primary:#1b365d;--accent:#2ecc71;--bg:#f5f7fb;--text:#2b2b2b;--muted:#6b7280;--card:#ffffff;--shadow:0 6px 18px rgba(0,0,0,.08);--shadow-hover:0 10px 24px rgba(0,0,0,.12);--radius:14px}
    *{box-sizing:border-box;margin:0;padding:0}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.5}
    header{background:var(--primary);color:#fff;padding:28px 16px;text-align:center}
    nav{background:#fff;padding:12px 0;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,.05)}
    nav a{margin:0 12px;text-decoration:none;color:var(--primary);font-weight:600}
    nav a:hover{text-decoration:underline}
    .container{max-width:1200px;margin:0 auto;padding:20px}
    .intro{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:22px;margin-top:-24px}
    .badge{display:inline-block;background:#eef2ff;color:#3442b5;border:1px solid #dbe2ff;border-radius:999px;padding:6px 12px;font-size:13px;margin-right:8px}
    .filters{display:flex;justify-content:center;gap:10px;margin:16px 0;flex-wrap:wrap}
    .filter-btn{padding:8px 16px;border:1px solid var(--primary);background:#fff;color:var(--primary);border-radius:8px;cursor:pointer;font-size:14px}
    .filter-btn.active{background:var(--primary);color:#fff}
    .search-wrap{display:flex;gap:10px;justify-content:center;margin:16px 0}
    .search-wrap input{width:100%;max-width:420px;padding:12px 14px;border:1px solid #d9dbe3;border-radius:10px;background:#fff}
    .events-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
    .event-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);display:flex;flex-direction:column;transition:.2s ease;overflow:hidden}
    .event-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-hover)}
    .event-header{padding:18px 18px 10px}
    .event-title{margin:0;color:var(--primary);font-size:18px;line-height:1.3}
    .event-desc{color:var(--muted);font-size:14px;padding:0 18px 10px}
    .card-actions{display:flex;gap:10px;padding:14px 18px 18px;margin-top:auto}
    .btn{border:none;border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:600}
    .btn-info{background:var(--primary);color:#fff}
    .btn-info:hover{opacity:.92}
    .btn-reg{background:var(--accent);color:#fff}
    .btn-reg:hover{filter:brightness(1.05)}
    /* Modals */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:1000;align-items:center;justify-content:center;padding:16px}
    .modal.open{display:flex}
    .modal-card{background:#fff;border-radius:16px;max-width:820px;width:100%;max-height:85vh;overflow:auto;box-shadow:var(--shadow-hover);position:relative;padding:20px}
    .modal-card h3{margin:4px 0 8px}
    .modal-close{position:absolute;top:10px;right:12px;background:transparent;border:none;font-size:24px;cursor:pointer}
    .preline{white-space:pre-line}
    /* Registration / Test / Result */
    .panel{background:#fff;border-radius:16px;box-shadow:var(--shadow);padding:20px;margin:22px 0;display:none}
    .panel h3{margin:6px 0 14px}
    .panel input{width:100%;padding:12px 12px;border:1px solid #d9dbe3;border-radius:10px;margin:6px 0 10px}
    .panel .muted{color:var(--muted);font-size:13px}
    .panel .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .panel .row .btn{margin-top:6px}
    .doc-banner{background:#f4f6ff;border:1px solid #dbe2ff;color:#334155;border-radius:10px;padding:10px 12px;margin:10px 0}
    .checkbox{display:flex;gap:10px;align-items:center;margin:8px 0;color:#111827}
    .checkbox input{width:auto}
    .btn-primary{background:var(--primary);color:#fff}
    .btn-disabled{background:#cbd5e1;color:#6b7280;cursor:not-allowed}
    /* --- тест (выравнивание слева, компактные отступы) --- */
    .question{
      padding:12px;
      border:1px solid #e5e7eb;
      border-radius:10px;
      margin:10px 0;
      text-align:left;            /* всё внутри строго слева */
    }
    .question p{
      margin:0 0 8px 0;           /* компактнее отступ под вопросом */
      font-weight:500;
      text-align:left;            /* на всякий */
    }
    /* контейнер с вариантами (на всякий случай) */
    #qBox{ text-align:left; }
    /* каждый вариант — сетка 2 колонки: [радио] [текст], чтобы переносы строк шли ровно */
    .radio{
      display:grid; 
      grid-template-columns: 18px 1fr;  /* ширина радиокнопки + текст */
      gap:8px;
      align-items:start;                 /* текст выравнивается по верхней линии радио */
      margin:4px 0;                      /* менее «воздушно» */
      text-align:left;                   /* на всякий */
    }
    .radio input{
      margin:2px 0 0 0;                 /* чуть опустить радио, чтобы совпадала линия с текстом */
    }
    .radio span{
      display:block;
      line-height:1.35;
      margin:0;
    }
    /* прочее в блоке результата тоже слева */
    .result-line{font-size:16px;margin:8px 0 4px;text-align:left;}
    .note{font-size:13px;color:var(--muted);text-align:left;}
    .divider{height:1px;background:#e5e7eb;margin:16px 0;}
    .center{text-align:center;}
    footer{background:var(--primary);color:#fff;padding:16px;text-align:center;font-size:14px;margin-top:40px}
    footer a{color:#fff;text-decoration:underline}
    .backgrounds-info { display: none; margin-top: 20px; padding: 15px; background: #f0f7ff; border-radius: 10px; }
  </style>
</head>
<body>
<header>
  <h1>Документы и оплата</h1>
</header>

<nav>
  <a href="/">Главная</a>
  <a href="/docs">Документы и оплата</a>
  <a href="/admin">Админка</a>
</nav>

<div class="container">
  <div class="intro">
    <div id="paymentText">Загрузка...</div>
    
    <div id="backgroundsInfo" class="backgrounds-info">
      <h4>Загрузка фонов для документов</h4>
      <p>Фоновые изображения (PNG) используются как водяные знаки в генерируемых PDF-документах.</p>
      <div id="backgroundsStatus"></div>
    </div>
  </div>
</div>

<footer>
  Почта для связи: <a href="mailto:naych_kooper@mail.ru">naych_kooper@mail.ru</a><br>
  © 2025 Все права защищены. Копирование контента без разрешения автора строго ЗАПРЕЩЕНО!
</footer>

<script>
// Загрузка текста оплаты и статуса фонов
async function loadPage() {
  const [settingsRes, backgroundsRes] = await Promise.all([
    fetch('/api/settings'),
    fetch('/api/backgrounds-status') // Новый эндпоинт для проверки фонов
  ]);
  
  const settings = await settingsRes.json();
  document.getElementById('paymentText').textContent = settings.paymentText;
  
  // Проверяем, есть ли загруженные фоны
  if (backgroundsRes.ok) {
    const status = await backgroundsRes.json();
    const hasAnyBackground = status.backgrounds.some(bg => bg.loaded);
    if (hasAnyBackground) {
      document.getElementById('backgroundsInfo').style.display = 'block';
      document.getElementById('backgroundsStatus').innerHTML = `
        <p><b>Текущие фоны:</b></p>
        <ul>
          ${status.backgrounds.map(bg => `<li>${bg.name}: ${bg.loaded ? 'Загружен' : 'Не загружен'}</li>`).join('')}
        </ul>
        <p><i>Перейдите в <a href="/admin">Админку</a>, чтобы загрузить фоны.</i></p>
      `;
    }
  }
}

loadPage();
</script>
</body>
</html>
