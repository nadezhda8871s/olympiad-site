{% extends "base.html" %}
{% block title %}{{ page_title }}{% endblock %}
{% block content %}
<style>
/* Fallback grid: 3 cards per row */
.cards-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:24px}
@media(max-width:1100px){.cards-grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
@media(max-width:700px){.cards-grid{grid-template-columns:1fr}}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:16px;display:flex;flex-direction:column}
.card-actions{margin-top:auto;display:flex;flex-wrap:wrap;gap:10px}
.nav-btn{display:inline-block;text-decoration:none;border:1px solid #d1d5db;border-radius:6px;padding:8px 12px}
.nav-btn--primary{background:#2563eb;border-color:#2563eb;color:#fff}
</style>
<section class="container">
  <h1>{{ page_title }}</h1>

  <form class="filters" method="get">
    <input type="text" name="q" value="{{ q }}" placeholder="Поиск по заголовку...">
    <label>
      с даты <input type="date" name="date_from" value="{{ request.GET.date_from }}">
    </label>
    <label>
      по дату <input type="date" name="date_to" value="{{ request.GET.date_to }}">
    </label>
    <button class="btn">Фильтровать</button>
  </form>

  <div class="cards-grid">
  {% for ev in events %}
    <div class="card">
      <h3 class="card-title"><a href="{{ ev.get_absolute_url }}">{{ ev.title }}</a></h3>
      <p class="card-desc">{{ ev.description|default:""|truncatechars:180 }}</p>
      <div class="card-actions">
        {% if ev.info_letter %}<a class="nav-btn" href="{{ ev.info_letter.url }}" target="_blank" rel="noopener">Информационное письмо</a>{% elif ev.info_file %}<a class="nav-btn" href="{{ ev.info_file.url }}" target="_blank" rel="noopener">Информационное письмо</a>{% endif %}
        <a class="nav-btn nav-btn--primary" href="{{ ev.get_register_url }}">Регистрация</a>
      </div>
    </div>
  {% empty %}
    <p>Нет мероприятий по заданным критериям.</p>
  {% endfor %}
  </div>
</section>
{% endblock %}
